{"ast":null,"code":"import _objectSpread from \"/Users/hucong/Desktop/workspace/creat-app/my/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _objectWithoutProperties from \"/Users/hucong/Desktop/workspace/creat-app/my/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _ from 'lodash';\nimport 'babel-polyfill'; // const fetch = require('fetch-ie8');\n\nimport fetch from 'fetch-ie8'; // console.log(fetch)\n\nvar Data = {};\n\nvar ajax = function ajax(_ref) {\n  var url = _ref.url,\n      _ref$method = _ref.method,\n      method = _ref$method === void 0 ? 'get' : _ref$method,\n      _ref$headers = _ref.headers,\n      headers = _ref$headers === void 0 ? {} : _ref$headers,\n      options = _objectWithoutProperties(_ref, [\"url\", \"method\", \"headers\"]);\n\n  if (!url) {\n    throw new Error(\"Property 'url' should not be empty!\");\n  }\n\n  if (url.indexOf('/') != 0 && url.indexOf('http') != 0) {// url = `${URL_PREFIX}/${url}`;\n  }\n\n  var isFormData = options.isFormData;\n  var originHeaders = {\n    'Content-Type': 'application/json;charset=utf-8'\n  };\n  var headersNew = !isFormData ? originHeaders : isFormData;\n  return fetch(url, _objectSpread({\n    method: method,\n    headers: _objectSpread({}, headersNew, headers)\n  }, options)).then(function (response) {\n    return response.json();\n  }).then(function (res) {\n    return newResult || res;\n  }).catch(function (err) {\n    console.error(err);\n    return Promise.resolve();\n  });\n}; // get 请求\n\n\nData.get = function (_ref2) {\n  var method = _ref2.method,\n      body = _ref2.body,\n      options = _objectWithoutProperties(_ref2, [\"method\", \"body\"]);\n\n  // 把body的参数拼接到url中，并把body参数去掉\n  if (_.isPlainObject(body)) {\n    var url = options.url;\n\n    if (url.indexOf('?') == -1) {\n      url += '?';\n    }\n\n    for (var key in body) {\n      url += \"\".concat(key, \"=\").concat(body[key], \"&\");\n    }\n\n    options.url = url.substring(0, url.length - 1);\n  }\n\n  return ajax(_objectSpread({\n    method: 'get'\n  }, options));\n}; // post 请求\n\n\nData.post = function (_ref3) {\n  var method = _ref3.method,\n      params = _ref3.params,\n      body = _ref3.body,\n      options = _objectWithoutProperties(_ref3, [\"method\", \"params\", \"body\"]);\n\n  if (_.isPlainObject(params)) {\n    params = JSON.stringify(params);\n  }\n\n  if (body || params) {\n    options.body = body || params;\n  }\n\n  return ajax(_objectSpread({\n    method: 'post'\n  }, options));\n};\n\nconsole.log(Data);\nexport default Data;","map":{"version":3,"sources":["/Users/hucong/Desktop/workspace/creat-app/my/src/client/data/index.js"],"names":["_","fetch","Data","ajax","url","method","headers","options","Error","indexOf","isFormData","originHeaders","headersNew","then","response","json","res","newResult","catch","err","console","error","Promise","resolve","get","body","isPlainObject","key","substring","length","post","params","JSON","stringify","log"],"mappings":"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","sourcesContent":["import _ from 'lodash';\r\nimport 'babel-polyfill'\r\n// const fetch = require('fetch-ie8');\r\nimport fetch from 'fetch-ie8';\r\n// console.log(fetch)\r\nlet Data ={}\r\nconst ajax = ({ url, method = 'get', headers = {}, ...options }) => {\r\n  if (!url) {\r\n    throw new Error(\"Property 'url' should not be empty!\");\r\n  }\r\n\r\n  if (url.indexOf('/') != 0 && url.indexOf('http') != 0) {\r\n    // url = `${URL_PREFIX}/${url}`;\r\n  }\r\n  const isFormData = options.isFormData;\r\n  const originHeaders = {\r\n      'Content-Type': 'application/json;charset=utf-8',\r\n  };\r\n  const headersNew = !isFormData ? originHeaders : isFormData;\r\n  return fetch(url, {\r\n    method,\r\n    headers: {\r\n        ...headersNew,\r\n        ...headers\r\n    },\r\n    ...options\r\n  })\r\n    .then(response => {\r\n      return response.json();\r\n    })\r\n    .then(res => {\r\n      return newResult || res;\r\n    })\r\n    .catch(err => {\r\n      console.error(err);\r\n      return Promise.resolve();\r\n    });\r\n};\r\n\r\n// get 请求\r\nData.get = ({ method, body, ...options }) => {\r\n  // 把body的参数拼接到url中，并把body参数去掉\r\n  if (_.isPlainObject(body)) {\r\n    let url = options.url;\r\n\r\n    if (url.indexOf('?') == -1) {\r\n      url += '?';\r\n    }\r\n\r\n    for (let key in body) {\r\n      url += `${key}=${body[key]}&`;\r\n    }\r\n\r\n    options.url = url.substring(0, url.length - 1);\r\n  }\r\n\r\n  return ajax({\r\n    method: 'get',\r\n    ...options\r\n  });\r\n};\r\n\r\n// post 请求\r\nData.post = ({ method, params, body, ...options }) => {\r\n  if (_.isPlainObject(params)) {\r\n    params = JSON.stringify(params);\r\n  }\r\n\r\n  if (body || params) {\r\n    options.body = body || params;\r\n  }\r\n\r\n  return ajax({\r\n    method: 'post',\r\n    ...options\r\n  });\r\n};\r\n\r\nconsole.log(Data)\r\nexport default  Data;\r\n"]},"metadata":{},"sourceType":"module"}